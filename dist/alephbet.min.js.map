{"version":3,"sources":["webpack://AlephBet/webpack/universalModuleDefinition","webpack://AlephBet/./node_modules/uuid/dist/esm-browser/rng.js","webpack://AlephBet/./node_modules/uuid/dist/esm-browser/regex.js","webpack://AlephBet/./node_modules/uuid/dist/esm-browser/validate.js","webpack://AlephBet/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://AlephBet/./src/options.js","webpack://AlephBet/./src/utils.js","webpack://AlephBet/./node_modules/uuid/dist/esm-browser/v4.js","webpack://AlephBet/./src/storage.js","webpack://AlephBet/./src/adapters.js","webpack://AlephBet/./src/alephbet.js","webpack://AlephBet/./node_modules/charenc/charenc.js","webpack://AlephBet/./node_modules/crypt/crypt.js","webpack://AlephBet/./node_modules/sha1/sha1.js","webpack://AlephBet/webpack/bootstrap","webpack://AlephBet/webpack/startup","webpack://AlephBet/webpack/runtime/define property getters","webpack://AlephBet/webpack/runtime/global","webpack://AlephBet/webpack/runtime/hasOwnProperty shorthand","webpack://AlephBet/webpack/runtime/make namespace object"],"names":["root","factory","exports","module","define","amd","self","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","uuid","byteToHex","i","push","toString","substr","debug","sha1","require","keys","Object","options","buf","offset","rnds","random","arr","arguments","length","undefined","toLowerCase","TypeError","defaults","obj","key","value","remove","list","callback","deletions","iterable","index","el","splice","indexOf","omit","results","Array","from","concat","apply","log","message","console","text","seed","parseInt","this","Math","check_weights","variants","contains_weight","weight","every","has_weight","sum_weights","sum","validate_weights","values","namespace","check","localStorage","setItem","removeItem","storage","JSON","parse","set","stringify","AlephbetAdapter","url","LocalStorageAdapter","_storage","_queue","get","queue_name","_flush","quuid","err","_res","utils","properties","_quuid","data","window","jQuery","ajax","method","success","xhr","XMLHttpRequest","params","entries","k","v","encodeURIComponent","join","replace","open","onload","status","send","_jquery_get","_plain_js_get","item","_remove_quuid","_ajax_get","experiment","goal","user_id","unique","name","variant","shift","_user_uuid","event","_track","goal_name","props","LamedAdapter","GimelAdapter","RailsAdapter","PersistentQueueGoogleAnalyticsAdapter","global","ga","_remove_uuid","category","action","label","hitCallback","nonInteraction","_props","PersistentQueueKeenAdapter","keen_client","client","addEvent","experiment_name","GoogleUniversalAnalyticsAdapter","Storage","Experiment","_options","validate","variant_names","run","get_stored_variant","activate_variant","conditionally_activate_variant","activate","trigger","in_sample","pick_variant","tracking","experiment_start","goal_complete","all_variants_have_weights","pick_weighted_variant","pick_unweighted_variant","weights_sum","weighted_index","ceil","_random","partitions","chosen_partition","floor","active","sample","salt","add_experiment","goals","add_goal","storage_adapter","tracking_adapter","Goal","experiments","charenc","utf8","stringToBytes","str","bin","unescape","bytesToString","bytes","decodeURIComponent","escape","charCodeAt","String","fromCharCode","base64map","crypt","rotl","n","b","rotr","endian","constructor","Number","randomBytes","bytesToWords","words","wordsToBytes","bytesToHex","hex","hexToBytes","c","bytesToBase64","base64","triplet","j","charAt","base64ToBytes","imod4","pow","api","digestbytes","Buffer","isBuffer","prototype","slice","call","isArray","m","l","w","H0","H1","H2","H3","H4","a","d","e","t","asBytes","asString","_blocksize","_digestsize","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","definition","o","defineProperty","enumerable","g","globalThis","Function","prop","hasOwnProperty","r","Symbol","toStringTag"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAkB,SAAID,IAEtBD,EAAe,SAAIC,IARrB,CASGK,MAAM,WACT,M,wCCPA,IAAIC,E,kTACJ,IAAIC,EAAQ,IAAIC,WAAW,IACZ,SAASC,IAEtB,IAAKH,KAGHA,EAAoC,oBAAXI,QAA0BA,OAAOJ,iBAAmBI,OAAOJ,gBAAgBK,KAAKD,SAA+B,oBAAbE,UAAgE,mBAA7BA,SAASN,iBAAkCM,SAASN,gBAAgBK,KAAKC,WAGrO,MAAM,IAAIC,MAAM,4GAIpB,OAAOP,EAAgBC,GCjBzB,8HCMA,EAJA,SAAkBO,GAChB,MAAuB,iBAATA,GAAqB,OAAWA,ICKhD,IAFA,IAAIC,EAAY,GAEPC,EAAI,EAAGA,EAAI,MAAOA,EACzBD,EAAUE,MAAMD,EAAI,KAAOE,SAAS,IAAIC,OAAO,IAoBjD,MC7BA,GACEC,OAAO,G,iyBCET,IAAMC,EAAOC,EAAQ,KAgFrB,QA9Ec,CACZC,KAAMC,OAAOD,KACbT,KCJF,SAAYW,EAASC,EAAKC,GAExB,IAAIC,GADJH,EAAUA,GAAW,IACFI,SAAWJ,EAAQhB,KAAOA,KAK7C,GAHAmB,EAAK,GAAe,GAAVA,EAAK,GAAY,GAC3BA,EAAK,GAAe,GAAVA,EAAK,GAAY,IAEvBF,EAAK,CACPC,EAASA,GAAU,EAEnB,IAAK,IAAIX,EAAI,EAAGA,EAAI,KAAMA,EACxBU,EAAIC,EAASX,GAAKY,EAAKZ,GAGzB,OAAOU,EAGT,OHRF,SAAmBI,GACjB,IAAIH,EAASI,UAAUC,OAAS,QAAsBC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,EAG7EjB,GAAQC,EAAUe,EAAIH,EAAS,IAAMZ,EAAUe,EAAIH,EAAS,IAAMZ,EAAUe,EAAIH,EAAS,IAAMZ,EAAUe,EAAIH,EAAS,IAAM,IAAMZ,EAAUe,EAAIH,EAAS,IAAMZ,EAAUe,EAAIH,EAAS,IAAM,IAAMZ,EAAUe,EAAIH,EAAS,IAAMZ,EAAUe,EAAIH,EAAS,IAAM,IAAMZ,EAAUe,EAAIH,EAAS,IAAMZ,EAAUe,EAAIH,EAAS,IAAM,IAAMZ,EAAUe,EAAIH,EAAS,KAAOZ,EAAUe,EAAIH,EAAS,KAAOZ,EAAUe,EAAIH,EAAS,KAAOZ,EAAUe,EAAIH,EAAS,KAAOZ,EAAUe,EAAIH,EAAS,KAAOZ,EAAUe,EAAIH,EAAS,MAAMO,cAMzf,IAAK,EAASpB,GACZ,MAAMqB,UAAU,+BAGlB,OAAOrB,EGNA,CAAUc,IDXjBQ,SAAU,SAACC,EAAKD,GACd,IAAK,IAAME,KAAOF,EAAU,CAC1B,IAAMG,EAAQH,EAASE,QACNL,IAAbI,EAAIC,KACND,EAAIC,GAAOC,GAGf,OAAOF,GAGTG,OAAQ,SAACC,EAAMC,GAGb,IAFA,IAAMC,EAAY,GACZC,E,+CAAeH,I,6iBACZI,EAAQ,EAAGA,EAAQD,EAASZ,OAAQa,IAAS,CACpD,IAAMC,EAAKF,EAASC,GAChBH,EAASI,EAAID,KACfJ,EAAKM,OAAON,EAAKO,QAAQF,GAAK,GAC9BH,EAAU1B,KAAK6B,I,MAGnB,OAAOH,GAGTM,KAAM,SAACZ,GAAiB,IACtB,IAAMa,EAAU,EAAH,GAAOb,GADE,mBAATd,EAAS,iCAATA,EAAS,kBAEtB,cAAkB4B,MAAMC,KAAK,GAAGC,OAAOC,MAAM,GAAI/B,IAAjD,eAAyD,CAApD,IAAMe,EAAG,YACLY,EAAQZ,GAEjB,OAAOY,GAGTK,IAAK,SAACC,GACA/B,EAAQL,OAEVqC,QAAQF,IAAIC,IAIhBnC,KAAM,SAACqC,GAAD,OAAUrC,EAAKqC,GAAMxC,YAE3BW,OA5CY,SA4CL8B,GACL,OAAKA,EAEEC,SAASC,KAAKxC,KAAKsC,GAAMxC,OAAO,EAAG,IAAK,IAAM,gBAFnC2C,KAAKjC,UAKzBkC,cAAe,SAACC,GACd,IAAMC,EAAkB,GACxB,IAAK,IAAM3B,KAAO0B,EAAU,CAC1B,IAAMzB,EAAQyB,EAAS1B,GAAM2B,EAAgBhD,KAAqB,MAAhBsB,EAAM2B,QAE1D,OAAOD,EAAgBE,OAAM,SAAAC,GAAU,OAAIA,MAG7CC,YAAa,SAACL,GACZ,IAAIM,EAAM,EACV,IAAK,IAAMhC,KAAO0B,EAEhBM,GADcN,EAAS1B,GACV4B,QAAU,EAEzB,OAAOI,GAGTC,iBAAkB,SAACP,GAEjB,IADA,IAAMC,EAAkB,GACxB,MAAoBzC,OAAOgD,OAAOR,GAAlC,eAA6C,CAAxC,IAAMzB,EAAK,KACd0B,EAAgBhD,KAAqB,MAAhBsB,EAAM2B,QAE7B,OAAOD,EAAgBE,OAAM,SAAAC,GAAU,OACrCA,GAAcH,EAAgBE,OAAM,SAAAC,GAAU,OAAKA,U,oQEpDzD,Q,WAxBE,aAAoC,IAAxBK,EAAwB,uDAAZ,WAAY,UAClCZ,KAAKY,UAAYA,EACjB,IACE,IAAMC,EAAQ,qBACdC,aAAaC,QAAQF,EAAOA,GAC5BC,aAAaE,WAAWH,GACxBb,KAAKiB,QAAUC,KAAKC,MAAML,aAAad,KAAKY,YAAc,MAC1D,SACA,MAAM,IAAI5D,MAAM,kC,iDAIhByB,EAAKC,GAGP,OAFAsB,KAAKiB,QAAQxC,GAAOC,EACpBoC,aAAaM,IAAIpB,KAAKY,UAAWM,KAAKG,UAAUrB,KAAKiB,UAC9CvC,I,0BAGLD,GACF,OAAOuB,KAAKiB,QAAQxC,Q,swGCZjB,IAAM6C,EAAb,WAGE,WAAYC,GAA4D,IAAvDX,EAAuD,uDAA3C,WAAYK,EAA+B,uDAArBO,EAAqB,UACtExB,KAAKyB,SAAWR,EAChBjB,KAAKuB,IAAMA,EACXvB,KAAKY,UAAYA,EACjBZ,KAAK0B,OAASR,KAAKC,MAAMnB,KAAKyB,SAASE,IAAI3B,KAAK4B,aAAe,MAC/D5B,KAAK6B,SART,gDAWgBC,GAAO,WACnB,OAAO,SAACC,EAAKC,GACPD,IACJE,SAAa,EAAKP,QAAQ,SAAAzC,GAAE,OAAIA,EAAGiD,WAAWC,SAAWL,KACzD,EAAKL,SAASL,IAAI,EAAKQ,WAAYV,KAAKG,UAAU,EAAKK,aAf7D,kCAmBcH,EAAKa,EAAMvD,GAErB,OADAoD,MAAU,6BACHI,OAAOC,OAAOC,KAAK,CACxBC,OAAQ,MACRjB,MACAa,OACAK,QAAS5D,MAzBf,oCA6BgB0C,EAAKa,EAAMvD,GACvBoD,MAAU,4BACV,IAAMS,EAAM,IAAIC,eACZC,EAAS,GACb,aAAqBjF,OAAOkF,QAAQT,GAAO,cAA/BU,EAA+B,KAA5BC,EAA4B,KACzCH,EAAOxF,KAAP,UAAe4F,mBAAmBF,GAAlC,YAAwCE,mBAAmBD,KAO7D,OALAH,EAASA,EAAOK,KAAK,KAAKC,QAAQ,OAAQ,KAC1CR,EAAIS,KAAK,MAAT,UAAmB5B,EAAnB,YAA0BqB,IAC1BF,EAAIU,OAAS,WACQ,MAAfV,EAAIW,QAAgBxE,KAEnB6D,EAAIY,SAzCf,gCA4CY/B,EAAKa,EAAMvD,GAAU,MAC7B,iBAAIwD,OAAOC,cAAX,OAAI,EAAeC,KACVvC,KAAKuD,YAAYhC,EAAKa,EAAMvD,GAE9BmB,KAAKwD,cAAcjC,EAAKa,EAAMvD,KAhDzC,+BAmDW,UACYmB,KAAK0B,QADjB,IACP,2BAAgC,KAArB+B,EAAqB,QACxB5E,EAAWmB,KAAK0D,cAAcD,EAAKvB,WAAWC,QACpDnC,KAAK2D,UAAU3D,KAAKuB,IAAKU,EAAM7C,KAAKqE,EAAKvB,WAAY,UAAWrD,IAH3D,iCAnDX,iCA0Da+E,EAAYC,GACrB,OAAKD,EAAWE,SAEXD,EAAKE,OAGH9B,EAAMzE,KAAN,UACFwC,KAAKY,UADH,YACgBgD,EAAWI,KAD3B,YACmCH,EAAKG,KADxC,YACgDJ,EAAWE,UANlC7B,EAAMhF,SA3D1C,6BAqES2G,EAAYK,EAASJ,GAC1B5B,MACE,qCACGjC,KAAKY,UADR,aACsBgD,EAAWI,KADjC,aAC0CC,EAD1C,aACsDJ,EAAKG,OAEzDhE,KAAK0B,OAAOvD,OAAS,KAAK6B,KAAK0B,OAAOwC,QAC1ClE,KAAK0B,OAAOtE,KAAK,CACf8E,WAAY,CACV0B,WAAYA,EAAWI,KACvB7B,OAAQF,EAAMhF,OACdA,KAAM+C,KAAKmE,WAAWP,EAAYC,GAClCI,UACAG,MAAOP,EAAKG,KACZpD,UAAWZ,KAAKY,aAGpBZ,KAAKyB,SAASL,IAAIpB,KAAK4B,WAAYV,KAAKG,UAAUrB,KAAK0B,SACvD1B,KAAK6B,WAtFT,uCAyFmB+B,EAAYK,GAC3BjE,KAAKqE,OAAOT,EAAYK,EAAS,CAACD,KAAM,cAAeD,QAAQ,MA1FnE,oCA6FgBH,EAAYK,EAASK,EAAWC,GAC5CvE,KAAKqE,OAAOT,EAAYK,EAAShC,EAAM1D,SAAS,CAACyF,KAAMM,GAAYC,QA9FvE,K,EAAajD,E,aACS,mBAoGf,IAAMkD,EAAb,8FAAkClD,G,EAArBkD,E,aACS,gBASf,IAAMC,EAAb,iIAGab,EAAYC,GACrB,OAAKD,EAAWE,SAEXD,EAAKE,OAGH9B,EAAMzE,KAAN,UACFwC,KAAKY,UADH,YACgBgD,EAAWI,KAD3B,YACmCJ,EAAWE,UANrB7B,EAAMhF,WAJ1C,GAAkCqE,G,EAArBmD,E,aACS,gBAiBf,IAAMC,EAAb,8FAAkCpD,G,EAArBoD,E,aACS,gBAGf,IAAMC,EAAb,WAIE,aAA2C,IAA/B1D,EAA+B,uDAArBO,EAAqB,UACzCxB,KAAKyB,SAAWR,EAChBjB,KAAK0B,OAASR,KAAKC,MAAMnB,KAAKyB,SAASE,IAAI3B,KAAK4B,aAAe,MAC/D5B,KAAK6B,SAPT,+CAUe5E,GAAM,WACjB,OAAO,WACLgF,SAAa,EAAKP,QAAQ,SAAAzC,GAAE,OAAIA,EAAGhC,OAASA,KAC5C,EAAKwE,SAASL,IAAI,EAAKQ,WAAYV,KAAKG,UAAU,EAAKK,YAb7D,+BAkBI,GAAyB,mBAAdkD,IAAOC,GAChB,MAAM,IAAI7H,MACR,iFAHG,UAOYgD,KAAK0B,QAPjB,IAOP,2BAAgC,KAArB+B,EAAqB,QACxB5E,EAAWmB,KAAK8E,aAAarB,EAAKxG,MACxC2H,IAAOC,GAAG,OAAQ,QAASpB,EAAKsB,SAAUtB,EAAKuB,OAAQvB,EAAKwB,MAAO,CACjEC,YAAarG,EACbsG,eAAgB,KAXb,iCAjBX,6BAiCSJ,EAAUC,EAAQC,GACvBhD,MACE,gEACG8C,EADH,aACgBC,EADhB,aAC2BC,IAEzBjF,KAAK0B,OAAOvD,OAAS,KAAK6B,KAAK0B,OAAOwC,QAC1ClE,KAAK0B,OAAOtE,KAAK,CAACH,KAAMgF,EAAMhF,OAAQ8H,WAAUC,SAAQC,UACxDjF,KAAKyB,SAASL,IAAIpB,KAAK4B,WAAYV,KAAKG,UAAUrB,KAAK0B,SACvD1B,KAAK6B,WAzCT,uCA4CmB+B,EAAYK,GAC3BjE,KAAKqE,OAAOrE,KAAKY,UAAjB,UAA+BgD,EAAWI,KAA1C,cAAoDC,GAAW,cA7CnE,oCAgDgBL,EAAYK,EAASK,EAAWc,GAC5CpF,KAAKqE,OAAOrE,KAAKY,UAAjB,UAA+BgD,EAAWI,KAA1C,cAAoDC,GAAWK,OAjDnE,K,EAAaK,E,YACQ,Y,EADRA,E,aAES,aAmDf,IAAMU,EAAb,WAGE,WAAYC,GAA4C,IAA/BrE,EAA+B,uDAArBO,EAAqB,UACtDxB,KAAKuF,OAASD,EACdtF,KAAKyB,SAAWR,EAChBjB,KAAK0B,OAASR,KAAKC,MAAMnB,KAAKyB,SAASE,IAAI3B,KAAK4B,aAAe,MAC/D5B,KAAK6B,SAPT,gDAUgBC,GAAO,WACnB,OAAO,SAACC,EAAKC,GACPD,IACJE,SAAa,EAAKP,QAAQ,SAAAzC,GAAE,OAAIA,EAAGiD,WAAWC,SAAWL,KACzD,EAAKL,SAASL,IAAI,EAAKQ,WAAYV,KAAKG,UAAU,EAAKK,aAd7D,+BAmBI,cAAmBpC,MAAMC,KAAKS,KAAK0B,QAAnC,eAA4C,CAAvC,IAAM+B,EAAI,KACP5E,EAAWmB,KAAK0D,cAAcD,EAAKvB,WAAWC,QACpDnC,KAAKuF,OAAOC,SACV/B,EAAKgC,gBACLxD,EAAM7C,KAAKqE,EAAKvB,WAAY,UAC5BrD,MAxBR,iCA6Ba+E,EAAYC,GACrB,OAAKD,EAAWE,SAEXD,EAAKE,OAGH9B,EAAMzE,KAAN,UACFwC,KAAKY,UADH,YACgBgD,EAAWI,KAD3B,YACmCJ,EAAWE,UANrB7B,EAAMhF,SA9B1C,6BAwCS2G,EAAYK,EAASJ,GAC1B5B,MACE,0CACG2B,EAAWI,KADd,aACuBC,EADvB,aACmCJ,EAAKG,OAEtChE,KAAK0B,OAAOvD,OAAS,KAAK6B,KAAK0B,OAAOwC,QAC1ClE,KAAK0B,OAAOtE,KAAK,CACfqI,gBAAiB7B,EAAWI,KAC5B9B,WAAY,CACVC,OAAQF,EAAMhF,OACdA,KAAM+C,KAAKmE,WAAWP,EAAYC,GAClCI,UACAG,MAAOP,EAAKG,QAGhBhE,KAAKyB,SAASL,IAAIpB,KAAK4B,WAAYV,KAAKG,UAAUrB,KAAK0B,SACvD1B,KAAK6B,WAxDT,uCA2DmB+B,EAAYK,GAC3BjE,KAAKqE,OAAOT,EAAYK,EAAS,CAACD,KAAM,cAAeD,QAAQ,MA5DnE,oCA+DgBH,EAAYK,EAASK,EAAWC,GAC5CvE,KAAKqE,OAAOT,EAAYK,EAAShC,EAAM1D,SAAS,CAACyF,KAAMM,GAAYC,QAhEvE,K,EAAac,E,aACS,eAmEf,IAAMK,EAAb,gFAGgBX,EAAUC,EAAQC,GAI9B,GAHAhD,MAAA,4CACuC8C,EADvC,aACoDC,EADpD,aAC+DC,IAEtC,mBAAdL,IAAOC,GAChB,MAAM,IAAI7H,MACR,iFAIJ4H,IAAOC,GAAG,OAAQ,QAASE,EAAUC,EAAQC,EAAO,CAACE,eAAgB,MAbzE,uCAgB0BvB,EAAYK,GAClCjE,KAAKqE,OAAOrE,KAAKY,UAAjB,UAA+BgD,EAAWI,KAA1C,cAAoDC,GAAW,cAjBnE,oCAoBuBL,EAAYK,EAASK,EAAWc,GACnDpF,KAAKqE,OAAOrE,KAAKY,UAAjB,UAA+BgD,EAAWI,KAA1C,cAAoDC,GAAWK,OArBnE,K,EAAaoB,E,YACQ,YAwBd,IAAMlE,EAAsB,CACjCZ,UAAW,WAEXQ,IAHiC,SAG7B3C,EAAKC,GACP,OAAO,IAAIiH,EAAQ3F,KAAKY,WAAWQ,IAAI3C,EAAKC,IAG9CiD,IAPiC,SAO7BlD,GACF,OAAO,IAAIkH,EAAQ3F,KAAKY,WAAWe,IAAIlD,K,i3DChSpC,I,MAAMmH,EAAb,WAaE,aAA0B,IAAdhI,EAAc,uDAAJ,GAAI,UACxBoC,KAAKpC,QAAUA,EACfqE,WAAejC,KAAKpC,QAASgI,EAAWC,UACxCC,EAAS9F,KAAKpC,SACdoC,KAAKgE,KAAOhE,KAAKpC,QAAQoG,KACzBhE,KAAKG,SAAWH,KAAKpC,QAAQuC,SAC7BH,KAAK8D,QAAU9D,KAAKpC,QAAQkG,QAC5B9D,KAAK+F,cAAgB9D,EAAMvE,KAAKsC,KAAKG,UACrCH,KAAKgG,MArBT,wCAyBI/D,MAAA,gCAAmCf,KAAKG,UAAUrB,KAAKpC,WACvD,IAAMqG,EAAUjE,KAAKiG,qBACjBhC,GAEFhC,MAAA,UAAagC,EAAb,YACAjE,KAAKkG,iBAAiBjC,IAEtBjE,KAAKmG,mCAhCX,uCAoCmBlC,GAAS,MACxB,UAAAjE,KAAKG,SAAS8D,UAAd,SAAwBmC,SAASpG,MACjCA,KAAKiB,UAAUG,IAAf,UAAsBpB,KAAKpC,QAAQoG,KAAnC,YAAmDC,KAtCvD,uDA2CI,GAAKjE,KAAKpC,QAAQyI,YAClBpE,MAAU,eACLjC,KAAKsG,aAAV,CACArE,MAAU,aACV,IAAMgC,EAAUjE,KAAKuG,eACrBvG,KAAKwG,WAAWC,iBAAiBzG,KAAMiE,GACvCjE,KAAKkG,iBAAiBjC,MAjD1B,oCAoDgBK,GAAuB,IAAZC,EAAY,uDAAJ,GAE/B,GADAtC,WAAesC,EAAO,CAACR,QAAQ,KAE7BQ,EAAMR,SACN/D,KAAKiB,UAAUU,IAAf,UAAsB3B,KAAKpC,QAAQoG,KAAnC,YAA2CM,IAF7C,CAIA,IAAML,EAAUjE,KAAKiG,qBAChBhC,IACDM,EAAMR,QACR/D,KAAKiB,UAAUG,IAAf,UAAsBpB,KAAKpC,QAAQoG,KAAnC,YAA2CM,IAAa,GAE1DrC,MACE,yBACGjC,KAAKpC,QAAQoG,KADhB,oBACgCC,EADhC,iBACgDK,EADhD,cAGFtE,KAAKwG,WAAWE,cAAc1G,KAAMiE,EAASK,EAAWC,OAnE5D,2CAuEI,OAAOvE,KAAKiB,UAAUU,IAAf,UAAsB3B,KAAKpC,QAAQoG,KAAnC,eAvEX,qCA2EI,IAAM2C,EAA4B1E,EAAM/B,cAAcF,KAAKG,UAE3D,OADA8B,MAAA,qCAAwC0E,IACpCA,EACK3G,KAAK4G,wBAEP5G,KAAK6G,4BAhFhB,8CA+FI,IAFA,IAAMC,EAAc7E,EAAMzB,YAAYR,KAAKG,UACvC4G,EAAiB9G,KAAK+G,KAAMhH,KAAKiH,QAAQ,WAAaH,GAC1D,MAA2BnJ,OAAOkF,QAAQ7C,KAAKG,UAA/C,eAA0D,iBAA9C1B,EAA8C,KAIxD,IADAsI,GAHwD,KAGhC1G,SACF,EAAG,OAAO5B,KAnGtC,gDAwGI,IAAMyI,EAAa,EAAMlH,KAAK+F,cAAc5H,OACtCgJ,EAAmBlH,KAAKmH,MAAMpH,KAAKiH,QAAQ,WAAaC,GACxDjD,EAAUjE,KAAK+F,cAAcoB,GAEnC,OADAlF,MAAA,UAAagC,EAAb,YACOA,IA5GX,kCAgHI,IAAIoD,EAASrH,KAAKiB,UAAUU,IAAf,UAAsB3B,KAAKpC,QAAQoG,KAAnC,eACb,YAAsB,IAAXqD,IACXA,EAASrH,KAAKiH,QAAQ,WAAajH,KAAKpC,QAAQ0J,OAChDtH,KAAKiB,UAAUG,IAAf,UAAsBpB,KAAKpC,QAAQoG,KAAnC,cAAqDqD,IAFXA,IAjH9C,8BAuHUE,GACN,IAAKvH,KAAK8D,QAAS,OAAO7B,EAAMjE,SAChC,IAAM8B,EAAO,GAAH,OAAME,KAAKgE,KAAX,YAAmBuD,EAAnB,YAA2BvH,KAAK8D,SAC1C,OAAO7B,EAAMjE,OAAO8B,KA1HxB,+BA6HW+D,GACPA,EAAK2D,eAAexH,QA9HxB,gCAiIYyH,GAAO,UACIA,GADJ,IACf,gCAAW5D,EAAX,QAA0B7D,KAAK0H,SAAS7D,IADzB,iCAjInB,gCAsII,OAAO7D,KAAKpC,QAAQ+J,kBAtIxB,iCA0II,OAAO3H,KAAKpC,QAAQgK,qBA1IxB,K,EACoB,CAChB5D,KAAM,KACN7D,SAAU,KACV2D,QAAS,KACTwD,OAAQ,EACRjB,QALgB,WAMd,OAAO,GAETuB,iBAAkBlC,EAClBiC,gBAAiBnG,I,kBAVRoE,G,sFA8Ib,IAAME,EAAW,SAAClI,GAChB,GAAqB,OAAjBA,EAAQoG,KACV,MAAM,IAAIhH,MAAM,wCAElB,GAAyB,OAArBY,EAAQuC,SACV,MAAM,IAAInD,MAAM,6BAElB,GAA+B,mBAApBY,EAAQyI,QACjB,MAAM,IAAIrJ,MAAM,8BAGlB,IADkCiF,EAAMvB,iBAAiB9C,EAAQuC,UAE/D,MAAM,IAAInD,MAAM,kCAIP6K,GAAb,WACE,WAAY7D,GAAkB,IAAZO,EAAY,uDAAJ,GAAI,UAC5BvE,KAAKgE,KAAOA,EACZhE,KAAKuE,MAAQA,EACbtC,WAAejC,KAAKuE,MAAO,CAACR,QAAQ,IACpC/D,KAAK8H,YAAc,GALvB,iDAQiBlE,GACb5D,KAAK8H,YAAY1K,KAAKwG,KAT1B,sCAYkBkE,GAAa,UACFA,GADE,IAC3B,gCAAWlE,EAAX,QAAsC5D,KAAKwH,eAAe5D,IAD/B,iCAZ/B,iCAgBa,UACgB5D,KAAK8H,aADrB,IACT,2BAA2C,QAC9BpB,cAAc1G,KAAKgE,KAAMhE,KAAKuE,OAFlC,mCAhBb,KA2BA,UAAgB3G,Y,QCjMhB,IAAImK,EAAU,CAEZC,KAAM,CAEJC,cAAe,SAASC,GACtB,OAAOH,EAAQI,IAAIF,cAAcG,SAASpF,mBAAmBkF,MAI/DG,cAAe,SAASC,GACtB,OAAOC,mBAAmBC,OAAOT,EAAQI,IAAIE,cAAcC,OAK/DH,IAAK,CAEHF,cAAe,SAASC,GACtB,IAAK,IAAII,EAAQ,GAAInL,EAAI,EAAGA,EAAI+K,EAAI/J,OAAQhB,IAC1CmL,EAAMlL,KAAyB,IAApB8K,EAAIO,WAAWtL,IAC5B,OAAOmL,GAITD,cAAe,SAASC,GACtB,IAAK,IAAIJ,EAAM,GAAI/K,EAAI,EAAGA,EAAImL,EAAMnK,OAAQhB,IAC1C+K,EAAI9K,KAAKsL,OAAOC,aAAaL,EAAMnL,KACrC,OAAO+K,EAAIjF,KAAK,OAKtB5G,EAAOD,QAAU2L,G,OChCjB,IACMa,EAGJC,EAHID,EACE,mEAENC,EAAQ,CAENC,KAAM,SAASC,EAAGC,GAChB,OAAQD,GAAKC,EAAMD,IAAO,GAAKC,GAIjCC,KAAM,SAASF,EAAGC,GAChB,OAAQD,GAAM,GAAKC,EAAOD,IAAMC,GAIlCE,OAAQ,SAASH,GAEf,GAAIA,EAAEI,aAAeC,OACnB,OAA0B,SAAnBP,EAAMC,KAAKC,EAAG,GAAsC,WAApBF,EAAMC,KAAKC,EAAG,IAIvD,IAAK,IAAI5L,EAAI,EAAGA,EAAI4L,EAAE5K,OAAQhB,IAC5B4L,EAAE5L,GAAK0L,EAAMK,OAAOH,EAAE5L,IACxB,OAAO4L,GAITM,YAAa,SAASN,GACpB,IAAK,IAAIT,EAAQ,GAAIS,EAAI,EAAGA,IAC1BT,EAAMlL,KAAK6C,KAAKmH,MAAsB,IAAhBnH,KAAKjC,WAC7B,OAAOsK,GAITgB,aAAc,SAAShB,GACrB,IAAK,IAAIiB,EAAQ,GAAIpM,EAAI,EAAG6L,EAAI,EAAG7L,EAAImL,EAAMnK,OAAQhB,IAAK6L,GAAK,EAC7DO,EAAMP,IAAM,IAAMV,EAAMnL,IAAO,GAAK6L,EAAI,GAC1C,OAAOO,GAITC,aAAc,SAASD,GACrB,IAAK,IAAIjB,EAAQ,GAAIU,EAAI,EAAGA,EAAmB,GAAfO,EAAMpL,OAAa6K,GAAK,EACtDV,EAAMlL,KAAMmM,EAAMP,IAAM,KAAQ,GAAKA,EAAI,GAAO,KAClD,OAAOV,GAITmB,WAAY,SAASnB,GACnB,IAAK,IAAIoB,EAAM,GAAIvM,EAAI,EAAGA,EAAImL,EAAMnK,OAAQhB,IAC1CuM,EAAItM,MAAMkL,EAAMnL,KAAO,GAAGE,SAAS,KACnCqM,EAAItM,MAAiB,GAAXkL,EAAMnL,IAAUE,SAAS,KAErC,OAAOqM,EAAIzG,KAAK,KAIlB0G,WAAY,SAASD,GACnB,IAAK,IAAIpB,EAAQ,GAAIsB,EAAI,EAAGA,EAAIF,EAAIvL,OAAQyL,GAAK,EAC/CtB,EAAMlL,KAAK2C,SAAS2J,EAAIpM,OAAOsM,EAAG,GAAI,KACxC,OAAOtB,GAITuB,cAAe,SAASvB,GACtB,IAAK,IAAIwB,EAAS,GAAI3M,EAAI,EAAGA,EAAImL,EAAMnK,OAAQhB,GAAK,EAElD,IADA,IAAI4M,EAAWzB,EAAMnL,IAAM,GAAOmL,EAAMnL,EAAI,IAAM,EAAKmL,EAAMnL,EAAI,GACxD6M,EAAI,EAAGA,EAAI,EAAGA,IACb,EAAJ7M,EAAY,EAAJ6M,GAAwB,EAAf1B,EAAMnK,OACzB2L,EAAO1M,KAAKwL,EAAUqB,OAAQF,IAAY,GAAK,EAAIC,GAAM,KAEzDF,EAAO1M,KAAK,KAElB,OAAO0M,EAAO7G,KAAK,KAIrBiH,cAAe,SAASJ,GAEtBA,EAASA,EAAO5G,QAAQ,iBAAkB,IAE1C,IAAK,IAAIoF,EAAQ,GAAInL,EAAI,EAAGgN,EAAQ,EAAGhN,EAAI2M,EAAO3L,OAC9CgM,IAAUhN,EAAI,EACH,GAATgN,GACJ7B,EAAMlL,MAAOwL,EAAUzJ,QAAQ2K,EAAOG,OAAO9M,EAAI,IAC1C8C,KAAKmK,IAAI,GAAI,EAAID,EAAQ,GAAK,IAAgB,EAARA,EACtCvB,EAAUzJ,QAAQ2K,EAAOG,OAAO9M,MAAS,EAAY,EAARgN,GAEtD,OAAO7B,IAIXjM,EAAOD,QAAUyM,G,cC9FnB,IACMA,EACAb,EACAG,EAmEJkC,EArEIxB,EAAQ,EAAQ,IAChBb,EAAO,YACPG,EAAM,YAmEVkC,EAAM,SAAU1K,EAAS/B,GACvB,IAAI0M,EAAczB,EAAMW,aAjEnB,SAAU7J,GAEXA,EAAQwJ,aAAeT,OACzB/I,EAAUqI,EAAKC,cAActI,GACJ,oBAAX4K,QAAoD,mBAAnBA,OAAOC,UAA0BD,OAAOC,SAAS7K,GAChGA,EAAUL,MAAMmL,UAAUC,MAAMC,KAAKhL,EAAS,GACtCL,MAAMsL,QAAQjL,KACtBA,EAAUA,EAAQtC,YAIpB,IAAIwN,EAAKhC,EAAMS,aAAa3J,GACxBmL,EAAsB,EAAjBnL,EAAQxB,OACb4M,EAAK,GACLC,EAAM,WACNC,GAAM,UACNC,GAAM,WACNC,EAAM,UACNC,GAAM,WAGVP,EAAEC,GAAK,IAAM,KAAS,GAAKA,EAAI,GAC/BD,EAA0B,IAAtBC,EAAI,KAAO,GAAM,IAAWA,EAEhC,IAAK,IAAI3N,EAAI,EAAGA,EAAI0N,EAAE1M,OAAQhB,GAAK,GAAI,CAOrC,IANA,IAAIkO,EAAIL,EACJhC,EAAIiC,EACJrB,EAAIsB,EACJI,EAAIH,EACJI,EAAIH,EAECpB,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAE3B,GAAIA,EAAI,GACNe,EAAEf,GAAKa,EAAE1N,EAAI6M,OACV,CACH,IAAIjB,EAAIgC,EAAEf,EAAI,GAAKe,EAAEf,EAAI,GAAKe,EAAEf,EAAI,IAAMe,EAAEf,EAAI,IAChDe,EAAEf,GAAMjB,GAAK,EAAMA,IAAM,GAG3B,IAAIyC,GAAMR,GAAM,EAAMA,IAAO,IAAOI,GAAML,EAAEf,KAAO,IAC3CA,EAAI,GAA4B,YAAtBiB,EAAKC,GAAMD,EAAKE,GAC1BnB,EAAI,GAAsB,YAAhBiB,EAAKC,EAAKC,GACpBnB,EAAI,IAAMiB,EAAKC,EAAKD,EAAKE,EAAKD,EAAKC,GAAM,YAC/BF,EAAKC,EAAKC,GAAM,WAElCC,EAAKD,EACLA,EAAKD,EACLA,EAAMD,GAAM,GAAOA,IAAO,EAC1BA,EAAKD,EACLA,EAAKQ,EAGPR,GAAMK,EACNJ,GAAMjC,EACNkC,GAAMtB,EACNuB,GAAMG,EACNF,GAAMG,EAGR,MAAO,CAACP,EAAIC,EAAIC,EAAIC,EAAIC,GAKa5N,CAAKmC,IAC1C,OAAO/B,GAAWA,EAAQ6N,QAAUnB,EAChC1M,GAAWA,EAAQ8N,SAAWvD,EAAIE,cAAciC,GAChDzB,EAAMY,WAAWa,KAGnBqB,WAAa,GACjBtB,EAAIuB,YAAc,GAElBvP,EAAOD,QAAUiO,IC/EfwB,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,GAAGF,EAAyBE,GAC3B,OAAOF,EAAyBE,GAAU3P,QAG3C,IAAIC,EAASwP,EAAyBE,GAAY,CAGjD3P,QAAS,IAOV,OAHA4P,EAAoBD,GAAU1P,EAAQA,EAAOD,QAAS0P,GAG/CzP,EAAOD,QCjBf,OCFA0P,EAAoBR,EAAI,CAAClP,EAAS6P,KACjC,IAAI,IAAIxN,KAAOwN,EACXH,EAAoBI,EAAED,EAAYxN,KAASqN,EAAoBI,EAAE9P,EAASqC,IAC5Ed,OAAOwO,eAAe/P,EAASqC,EAAK,CAAE2N,YAAY,EAAMzK,IAAKsK,EAAWxN,MCJ3EqN,EAAoBO,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOtM,MAAQ,IAAIuM,SAAS,cAAb,GACd,MAAOhB,GACR,GAAsB,iBAAXlJ,OAAqB,OAAOA,QALjB,GCAxByJ,EAAoBI,EAAI,CAAC1N,EAAKgO,IAAS7O,OAAO8M,UAAUgC,eAAe9B,KAAKnM,EAAKgO,GCCjFV,EAAoBY,EAAKtQ,IACH,oBAAXuQ,QAA0BA,OAAOC,aAC1CjP,OAAOwO,eAAe/P,EAASuQ,OAAOC,YAAa,CAAElO,MAAO,WAE7Df,OAAOwO,eAAe/P,EAAS,aAAc,CAAEsC,OAAO,KJFhDoN,EAAoB,M","file":"alephbet.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"AlephBet\"] = factory();\n\telse\n\t\troot[\"AlephBet\"] = factory();\n})(self, function() {\nreturn ","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","export default {\n  debug: false\n}\n","import {v4} from \"uuid\"\nimport options from \"./options\"\n\nconst sha1 = require(\"sha1\")\n\nconst Utils = {\n  keys: Object.keys,\n  uuid: v4,\n\n  defaults: (obj, defaults) => {\n    for (const key in defaults) {\n      const value = defaults[key]\n      if (obj[key] === undefined) {\n        obj[key] = value\n      }\n    }\n    return obj\n  },\n\n  remove: (list, callback) => {\n    const deletions = []\n    const iterable = [...list]\n    for (let index = 0; index < iterable.length; index++) {\n      const el = iterable[index]\n      if (callback(el, index)) {\n        list.splice(list.indexOf(el), 1)\n        deletions.push(el)\n      }\n    }\n    return deletions\n  },\n\n  omit: (obj, ...keys) => {\n    const results = {...obj}\n    for (const key of Array.from([].concat.apply([], keys))) {\n      delete results[key]\n    }\n    return results\n  },\n\n  log: (message) => {\n    if (options.debug) {\n      // eslint-disable-next-line no-console\n      console.log(message)\n    }\n  },\n\n  sha1: (text) => sha1(text).toString(),\n\n  random(seed) {\n    if (!seed) return Math.random()\n    // a MUCH simplified version inspired by PlanOut.js\n    return parseInt(this.sha1(seed).substr(0, 13), 16) / 0xFFFFFFFFFFFFF\n  },\n\n  check_weights: (variants) => {\n    const contains_weight = []\n    for (const key in variants) {\n      const value = variants[key]; contains_weight.push(value.weight != null)\n    }\n    return contains_weight.every(has_weight => has_weight)\n  },\n\n  sum_weights: (variants) => {\n    let sum = 0\n    for (const key in variants) {\n      const value = variants[key]\n      sum += value.weight || 0\n    }\n    return sum\n  },\n\n  validate_weights: (variants) => {\n    const contains_weight = []\n    for (const value of Object.values(variants)) {\n      contains_weight.push(value.weight != null)\n    }\n    return contains_weight.every(has_weight =>\n      has_weight || contains_weight.every(has_weight => !has_weight)\n    )\n  }\n}\n\nexport default Utils\n","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","// a thin wrapper around localStorage checking if localStorage is available\nclass Storage {\n  constructor(namespace = \"alephbet\") {\n    this.namespace = namespace\n    try {\n      const check = \"localstorage_check\"\n      localStorage.setItem(check, check)\n      localStorage.removeItem(check)\n      this.storage = JSON.parse(localStorage[this.namespace] || \"{}\")\n    } catch {\n      throw new Error(\"localStorage is not available\")\n    }\n  }\n\n  set(key, value) {\n    this.storage[key] = value\n    localStorage.set(this.namespace, JSON.stringify(this.storage))\n    return value\n  }\n\n  get(key) {\n    return this.storage[key]\n    // store.get(\"#{@namespace}:#{key}\")\n  }\n}\n\nexport default Storage\n","import Storage from \"./storage\"\nimport utils from \"./utils\"\n\n// # A parent class Adapter for using the Alephbet backend API.\n// # uses jQuery to send data if `$.ajax` is found. Falls back on plain js xhr\n// # params:\n// # - url: track URL to post events to\n// # - namepsace (optional): allows setting different environments etc\n// # - storage (optional): storage adapter for the queue\nexport class AlephbetAdapter {\n  static queue_name = \"_alephbet_queue\"\n\n  constructor(url, namespace = \"alephbet\", storage = LocalStorageAdapter) {\n    this._storage = storage\n    this.url = url\n    this.namespace = namespace\n    this._queue = JSON.parse(this._storage.get(this.queue_name) || \"[]\")\n    this._flush()\n  }\n\n  _remove_quuid(quuid) {\n    return (err, _res) => {\n      if (err) return\n      utils.remove(this._queue, el => el.properties._quuid === quuid)\n      this._storage.set(this.queue_name, JSON.stringify(this._queue))\n    }\n  }\n\n  _jquery_get(url, data, callback) {\n    utils.log(\"send request using jQuery\")\n    return window.jQuery.ajax({\n      method: \"GET\",\n      url,\n      data,\n      success: callback\n    })\n  }\n\n  _plain_js_get(url, data, callback) {\n    utils.log(\"fallback on plain js xhr\")\n    const xhr = new XMLHttpRequest()\n    let params = []\n    for (const [k, v] in Object.entries(data)) {\n      params.push(`${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n    }\n    params = params.join(\"&\").replace(/%20/g, \"+\")\n    xhr.open(\"GET\", `${url}?${params}`)\n    xhr.onload = () => {\n      if (xhr.status === 200) callback()\n    }\n    return xhr.send()\n  }\n\n  _ajax_get(url, data, callback) {\n    if (window.jQuery?.ajax) {\n      return this._jquery_get(url, data, callback)\n    }\n    return this._plain_js_get(url, data, callback)\n  }\n\n  _flush() {\n    for (const item of this._queue) {\n      const callback = this._remove_quuid(item.properties._quuid)\n      this._ajax_get(this.url, utils.omit(item.properties, \"_quuid\"), callback)\n    }\n  }\n\n  _user_uuid(experiment, goal) {\n    if (!experiment.user_id) return utils.uuid()\n    // if goal is not unique, we track it every time. return a new random uuid\n    if (!goal.unique) return utils.uuid()\n    // for a given user id, namespace, goal and experiment, the uuid will always be the same\n    // this avoids counting goals twice for the same user across different devices\n    return utils.sha1(\n      `${this.namespace}.${experiment.name}.${goal.name}.${experiment.user_id}`\n    )\n  }\n\n  _track(experiment, variant, goal) {\n    utils.log(\n      \"Persistent Queue track: \" +\n      `${this.namespace}, ${experiment.name}, ${variant}, ${goal.name}`\n    )\n    if (this._queue.length > 100) this._queue.shift()\n    this._queue.push({\n      properties: {\n        experiment: experiment.name,\n        _quuid: utils.uuid(), // queue uuid (used only internally)\n        uuid: this._user_uuid(experiment, goal),\n        variant,\n        event: goal.name,\n        namespace: this.namespace\n      }\n    })\n    this._storage.set(this.queue_name, JSON.stringify(this._queue))\n    this._flush()\n  }\n\n  experiment_start(experiment, variant) {\n    this._track(experiment, variant, {name: \"participate\", unique: true})\n  }\n\n  goal_complete(experiment, variant, goal_name, props) {\n    this._track(experiment, variant, utils.defaults({name: goal_name}, props))\n  }\n}\n\n// # Adapter for using the lamed backend. See https://github.com/Alephbet/lamed\n// # inherits from AlephbetAdapter which uses the same backend API\n// #\nexport class LamedAdapter extends AlephbetAdapter {\n  static queue_name = \"_lamed_queue\"\n}\n\n// # Adapter for using the gimel backend. See https://github.com/Alephbet/gimel\n// # The main difference is the user_uuid generation (for backwards compatibility)\n// # params:\n// # - url: Gimel track URL to post events to\n// # - namepsace: namespace for Gimel (allows setting different environments etc)\n// # - storage (optional) - storage adapter for the queue\nexport class GimelAdapter extends AlephbetAdapter {\n  static queue_name = \"_lamed_queue\"\n\n  _user_uuid(experiment, goal) {\n    if (!experiment.user_id) return utils.uuid()\n    // if goal is not unique, we track it every time. return a new random uuid\n    if (!goal.unique) return utils.uuid()\n    // for a given user id, namespace and experiment, the uuid will always be the same\n    // this avoids counting goals twice for the same user across different devices\n    return utils.sha1(\n      `${this.namespace}.${experiment.name}.${experiment.user_id}`\n    )\n  }\n}\n\n// # Adapter for using the lamed backend. See https://github.com/Alephbet/lamed\n// # inherits from AlephbetAdapter which uses the same backend API\n// #\nexport class RailsAdapter extends AlephbetAdapter {\n  static queue_name = \"_rails_queue\"\n}\n\nexport class PersistentQueueGoogleAnalyticsAdapter {\n  static namespace = \"alephbet\"\n  static queue_name = \"_ga_queue\"\n\n  constructor(storage = LocalStorageAdapter) {\n    this._storage = storage\n    this._queue = JSON.parse(this._storage.get(this.queue_name) || \"[]\")\n    this._flush()\n  }\n\n  _remove_uuid(uuid) {\n    return () => {\n      utils.remove(this._queue, el => el.uuid === uuid)\n      this._storage.set(this.queue_name, JSON.stringify(this._queue))\n    }\n  }\n\n  _flush() {\n    if (typeof global.ga !== \"function\") {\n      throw new Error(\n        \"ga not defined. \" +\n        \"Please make sure your Universal analytics is set up correctly\"\n      )\n    }\n    for (const item of this._queue) {\n      const callback = this._remove_uuid(item.uuid)\n      global.ga(\"send\", \"event\", item.category, item.action, item.label, {\n        hitCallback: callback,\n        nonInteraction: 1\n      })\n    }\n  }\n\n  _track(category, action, label) {\n    utils.log(\n      \"Persistent Queue Google Universal Analytics track: \" +\n      `${category}, ${action}, ${label}`\n    )\n    if (this._queue.length > 100) this._queue.shift()\n    this._queue.push({uuid: utils.uuid(), category, action, label})\n    this._storage.set(this.queue_name, JSON.stringify(this._queue))\n    this._flush()\n  }\n\n  experiment_start(experiment, variant) {\n    this._track(this.namespace, `${experiment.name} | ${variant}`, \"Visitors\")\n  }\n\n  goal_complete(experiment, variant, goal_name, _props) {\n    this._track(this.namespace, `${experiment.name} | ${variant}`, goal_name)\n  }\n}\n\nexport class PersistentQueueKeenAdapter {\n  static queue_name = \"_keen_queue\"\n\n  constructor(keen_client, storage = LocalStorageAdapter) {\n    this.client = keen_client\n    this._storage = storage\n    this._queue = JSON.parse(this._storage.get(this.queue_name) || \"[]\")\n    this._flush()\n  }\n\n  _remove_quuid(quuid) {\n    return (err, _res) => {\n      if (err) return\n      utils.remove(this._queue, el => el.properties._quuid === quuid)\n      this._storage.set(this.queue_name, JSON.stringify(this._queue))\n    }\n  }\n\n  _flush() {\n    for (const item of Array.from(this._queue)) {\n      const callback = this._remove_quuid(item.properties._quuid)\n      this.client.addEvent(\n        item.experiment_name,\n        utils.omit(item.properties, \"_quuid\"),\n        callback\n      )\n    }\n  }\n\n  _user_uuid(experiment, goal) {\n    if (!experiment.user_id) return utils.uuid()\n    // if goal is not unique, we track it every time. return a new random uuid\n    if (!goal.unique) return utils.uuid()\n    // for a given user id, namespace and experiment, the uuid will always be the same\n    // this avoids counting goals twice for the same user across different devices\n    return utils.sha1(\n      `${this.namespace}.${experiment.name}.${experiment.user_id}`\n    )\n  }\n\n  _track(experiment, variant, goal) {\n    utils.log(\n      \"Persistent Queue Keen track: \" +\n      `${experiment.name}, ${variant}, ${goal.name}`\n    )\n    if (this._queue.length > 100) this._queue.shift()\n    this._queue.push({\n      experiment_name: experiment.name,\n      properties: {\n        _quuid: utils.uuid(), // queue uuid (used only internally)\n        uuid: this._user_uuid(experiment, goal),\n        variant,\n        event: goal.name\n      }\n    })\n    this._storage.set(this.queue_name, JSON.stringify(this._queue))\n    this._flush()\n  }\n\n  experiment_start(experiment, variant) {\n    this._track(experiment, variant, {name: \"participate\", unique: true})\n  }\n\n  goal_complete(experiment, variant, goal_name, props) {\n    this._track(experiment, variant, utils.defaults({name: goal_name}, props))\n  }\n}\n\nexport class GoogleUniversalAnalyticsAdapter {\n  static namespace = \"alephbet\"\n\n  static _track(category, action, label) {\n    utils.log(\n      `Google Universal Analytics track: ${category}, ${action}, ${label}`\n    )\n    if (typeof global.ga !== \"function\") {\n      throw new Error(\n        \"ga not defined. Please make sure \" +\n        \"your Universal analytics is set up correctly\"\n      )\n    }\n    global.ga(\"send\", \"event\", category, action, label, {nonInteraction: 1})\n  }\n\n  static experiment_start(experiment, variant) {\n    this._track(this.namespace, `${experiment.name} | ${variant}`, \"Visitors\")\n  }\n\n  static goal_complete(experiment, variant, goal_name, _props) {\n    this._track(this.namespace, `${experiment.name} | ${variant}`, goal_name)\n  }\n}\n\nexport const LocalStorageAdapter = {\n  namespace: \"alephbet\",\n\n  set(key, value) {\n    return new Storage(this.namespace).set(key, value)\n  },\n\n  get(key) {\n    return new Storage(this.namespace).get(key)\n  }\n}\n\nexport default {\n  AlephbetAdapter,\n  LamedAdapter,\n  GimelAdapter,\n  RailsAdapter,\n  PersistentQueueGoogleAnalyticsAdapter,\n  PersistentQueueKeenAdapter,\n  GoogleUniversalAnalyticsAdapter,\n  LocalStorageAdapter\n}\n","import utils from \"./utils\"\nimport options from \"./options\"\n\nimport {\n  LocalStorageAdapter,\n  GoogleUniversalAnalyticsAdapter\n} from \"./adapters\"\n\nexport class Experiment {\n  static _options = {\n    name: null,\n    variants: null,\n    user_id: null,\n    sample: 1.0,\n    trigger() {\n      return true\n    },\n    tracking_adapter: GoogleUniversalAnalyticsAdapter,\n    storage_adapter: LocalStorageAdapter\n  }\n\n  constructor(options = {}) {\n    this.options = options\n    utils.defaults(this.options, Experiment._options)\n    validate(this.options)\n    this.name = this.options.name\n    this.variants = this.options.variants\n    this.user_id = this.options.user_id\n    this.variant_names = utils.keys(this.variants)\n    this.run()\n  }\n\n  run() {\n    utils.log(`running with options: ${JSON.stringify(this.options)}`)\n    const variant = this.get_stored_variant()\n    if (variant) {\n      // a variant was already chosen. activate it\n      utils.log(`${variant} active`)\n      this.activate_variant(variant)\n    } else {\n      this.conditionally_activate_variant()\n    }\n  }\n\n  activate_variant(variant) {\n    this.variants[variant]?.activate(this)\n    this.storage().set(`${this.options.name}:variant`, variant)\n  }\n\n  // if experiment conditions match, pick and activate a variant, track experiment start\n  conditionally_activate_variant() {\n    if (!this.options.trigger()) return\n    utils.log(\"trigger set\")\n    if (!this.in_sample()) return\n    utils.log(\"in sample\")\n    const variant = this.pick_variant()\n    this.tracking().experiment_start(this, variant)\n    this.activate_variant(variant)\n  }\n\n  goal_complete(goal_name, props = {}) {\n    utils.defaults(props, {unique: true})\n    if (\n      props.unique &&\n      this.storage().get(`${this.options.name}:${goal_name}`)\n    ) return\n    const variant = this.get_stored_variant()\n    if (!variant) return\n    if (props.unique) {\n      this.storage().set(`${this.options.name}:${goal_name}`, true)\n    }\n    utils.log(\n      \"experiment: \" +\n      `${this.options.name} variant:${variant} goal:${goal_name} complete`\n    )\n    this.tracking().goal_complete(this, variant, goal_name, props)\n  }\n\n  get_stored_variant() {\n    return this.storage().get(`${this.options.name}:variant`)\n  }\n\n  pick_variant() {\n    const all_variants_have_weights = utils.check_weights(this.variants)\n    utils.log(`all variants have weights: ${all_variants_have_weights}`)\n    if (all_variants_have_weights) {\n      return this.pick_weighted_variant()\n    }\n    return this.pick_unweighted_variant()\n  }\n\n  pick_weighted_variant() {\n    // Choosing a weighted variant:\n    // For A, B, C with weights 1, 3, 6\n    // variants = A, B, C\n    // weights = 1, 3, 6\n    // weights_sum = 10 (sum of weights)\n    // weighted_index = 2.1 (random number between 0 and weight sum)\n    // ABBBCCCCCC\n    // ==^\n    // Select B\n    const weights_sum = utils.sum_weights(this.variants)\n    let weighted_index = Math.ceil((this._random(\"variant\") * weights_sum))\n    for (const [key, value] of Object.entries(this.variants)) {\n      // then we are substracting variant weight from selected number\n      // and it it reaches 0 (or below) we are selecting this variant\n      weighted_index -= value.weight\n      if (weighted_index <= 0) return key\n    }\n  }\n\n  pick_unweighted_variant() {\n    const partitions = 1.0 / this.variant_names.length\n    const chosen_partition = Math.floor(this._random(\"variant\") / partitions)\n    const variant = this.variant_names[chosen_partition]\n    utils.log(`${variant} picked`)\n    return variant\n  }\n\n  in_sample() {\n    let active = this.storage().get(`${this.options.name}:in_sample`)\n    if (typeof active !== \"undefined\") return active\n    active = this._random(\"sample\") <= this.options.sample\n    this.storage().set(`${this.options.name}:in_sample`, active)\n    return active\n  }\n\n  _random(salt) {\n    if (!this.user_id) return utils.random()\n    const seed = `${this.name}.${salt}.${this.user_id}`\n    return utils.random(seed)\n  }\n\n  add_goal(goal) {\n    goal.add_experiment(this)\n  }\n\n  add_goals(goals) {\n    for (const goal of goals) this.add_goal(goal)\n  }\n\n  storage() {\n    return this.options.storage_adapter\n  }\n\n  tracking() {\n    return this.options.tracking_adapter\n  }\n}\n\nconst validate = (options) => {\n  if (options.name === null) {\n    throw new Error(\"an experiment name must be specified\")\n  }\n  if (options.variants === null) {\n    throw new Error(\"variants must be provided\")\n  }\n  if (typeof options.trigger !== \"function\") {\n    throw new Error(\"trigger must be a function\")\n  }\n  const all_variants_have_weights = utils.validate_weights(options.variants)\n  if (!all_variants_have_weights) {\n    throw new Error(\"not all variants have weights\")\n  }\n}\n\nexport class Goal {\n  constructor(name, props = {}) {\n    this.name = name\n    this.props = props\n    utils.defaults(this.props, {unique: true})\n    this.experiments = []\n  }\n\n  add_experiment(experiment) {\n    this.experiments.push(experiment)\n  }\n\n  add_experiments(experiments) {\n    for (const experiment of experiments) this.add_experiment(experiment)\n  }\n\n  complete() {\n    for (const experiment of this.experiments) {\n      experiment.goal_complete(this.name, this.props)\n    }\n  }\n}\n\nexport * from \"./adapters\"\nexport {default as utils} from \"./utils\"\nexport {default as options} from \"./options\"\n\nexport default {options}\n","var charenc = {\n  // UTF-8 encoding\n  utf8: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));\n    }\n  },\n\n  // Binary encoding\n  bin: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      for (var bytes = [], i = 0; i < str.length; i++)\n        bytes.push(str.charCodeAt(i) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      for (var str = [], i = 0; i < bytes.length; i++)\n        str.push(String.fromCharCode(bytes[i]));\n      return str.join('');\n    }\n  }\n};\n\nmodule.exports = charenc;\n","(function() {\n  var base64map\n      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n\n  crypt = {\n    // Bit-wise rotation left\n    rotl: function(n, b) {\n      return (n << b) | (n >>> (32 - b));\n    },\n\n    // Bit-wise rotation right\n    rotr: function(n, b) {\n      return (n << (32 - b)) | (n >>> b);\n    },\n\n    // Swap big-endian to little-endian and vice versa\n    endian: function(n) {\n      // If number given, swap endian\n      if (n.constructor == Number) {\n        return crypt.rotl(n, 8) & 0x00FF00FF | crypt.rotl(n, 24) & 0xFF00FF00;\n      }\n\n      // Else, assume array and swap all items\n      for (var i = 0; i < n.length; i++)\n        n[i] = crypt.endian(n[i]);\n      return n;\n    },\n\n    // Generate an array of any length of random bytes\n    randomBytes: function(n) {\n      for (var bytes = []; n > 0; n--)\n        bytes.push(Math.floor(Math.random() * 256));\n      return bytes;\n    },\n\n    // Convert a byte array to big-endian 32-bit words\n    bytesToWords: function(bytes) {\n      for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)\n        words[b >>> 5] |= bytes[i] << (24 - b % 32);\n      return words;\n    },\n\n    // Convert big-endian 32-bit words to a byte array\n    wordsToBytes: function(words) {\n      for (var bytes = [], b = 0; b < words.length * 32; b += 8)\n        bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a hex string\n    bytesToHex: function(bytes) {\n      for (var hex = [], i = 0; i < bytes.length; i++) {\n        hex.push((bytes[i] >>> 4).toString(16));\n        hex.push((bytes[i] & 0xF).toString(16));\n      }\n      return hex.join('');\n    },\n\n    // Convert a hex string to a byte array\n    hexToBytes: function(hex) {\n      for (var bytes = [], c = 0; c < hex.length; c += 2)\n        bytes.push(parseInt(hex.substr(c, 2), 16));\n      return bytes;\n    },\n\n    // Convert a byte array to a base-64 string\n    bytesToBase64: function(bytes) {\n      for (var base64 = [], i = 0; i < bytes.length; i += 3) {\n        var triplet = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n        for (var j = 0; j < 4; j++)\n          if (i * 8 + j * 6 <= bytes.length * 8)\n            base64.push(base64map.charAt((triplet >>> 6 * (3 - j)) & 0x3F));\n          else\n            base64.push('=');\n      }\n      return base64.join('');\n    },\n\n    // Convert a base-64 string to a byte array\n    base64ToBytes: function(base64) {\n      // Remove non-base-64 characters\n      base64 = base64.replace(/[^A-Z0-9+\\/]/ig, '');\n\n      for (var bytes = [], i = 0, imod4 = 0; i < base64.length;\n          imod4 = ++i % 4) {\n        if (imod4 == 0) continue;\n        bytes.push(((base64map.indexOf(base64.charAt(i - 1))\n            & (Math.pow(2, -2 * imod4 + 8) - 1)) << (imod4 * 2))\n            | (base64map.indexOf(base64.charAt(i)) >>> (6 - imod4 * 2)));\n      }\n      return bytes;\n    }\n  };\n\n  module.exports = crypt;\n})();\n","(function() {\n  var crypt = require('crypt'),\n      utf8 = require('charenc').utf8,\n      bin = require('charenc').bin,\n\n  // The core\n  sha1 = function (message) {\n    // Convert to byte array\n    if (message.constructor == String)\n      message = utf8.stringToBytes(message);\n    else if (typeof Buffer !== 'undefined' && typeof Buffer.isBuffer == 'function' && Buffer.isBuffer(message))\n      message = Array.prototype.slice.call(message, 0);\n    else if (!Array.isArray(message))\n      message = message.toString();\n\n    // otherwise assume byte array\n\n    var m  = crypt.bytesToWords(message),\n        l  = message.length * 8,\n        w  = [],\n        H0 =  1732584193,\n        H1 = -271733879,\n        H2 = -1732584194,\n        H3 =  271733878,\n        H4 = -1009589776;\n\n    // Padding\n    m[l >> 5] |= 0x80 << (24 - l % 32);\n    m[((l + 64 >>> 9) << 4) + 15] = l;\n\n    for (var i = 0; i < m.length; i += 16) {\n      var a = H0,\n          b = H1,\n          c = H2,\n          d = H3,\n          e = H4;\n\n      for (var j = 0; j < 80; j++) {\n\n        if (j < 16)\n          w[j] = m[i + j];\n        else {\n          var n = w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16];\n          w[j] = (n << 1) | (n >>> 31);\n        }\n\n        var t = ((H0 << 5) | (H0 >>> 27)) + H4 + (w[j] >>> 0) + (\n                j < 20 ? (H1 & H2 | ~H1 & H3) + 1518500249 :\n                j < 40 ? (H1 ^ H2 ^ H3) + 1859775393 :\n                j < 60 ? (H1 & H2 | H1 & H3 | H2 & H3) - 1894007588 :\n                         (H1 ^ H2 ^ H3) - 899497514);\n\n        H4 = H3;\n        H3 = H2;\n        H2 = (H1 << 30) | (H1 >>> 2);\n        H1 = H0;\n        H0 = t;\n      }\n\n      H0 += a;\n      H1 += b;\n      H2 += c;\n      H3 += d;\n      H4 += e;\n    }\n\n    return [H0, H1, H2, H3, H4];\n  },\n\n  // Public API\n  api = function (message, options) {\n    var digestbytes = crypt.wordsToBytes(sha1(message));\n    return options && options.asBytes ? digestbytes :\n        options && options.asString ? bin.bytesToString(digestbytes) :\n        crypt.bytesToHex(digestbytes);\n  };\n\n  api._blocksize = 16;\n  api._digestsize = 20;\n\n  module.exports = api;\n})();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(551);\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}